import{u as _,a as h,b as S,j as e,L,_ as c,r as k,S as $,c as q}from"./index-35v143-v.js";import{T as D,B as M,c as O,a as o,F as T,b as A,d as m,E as d}from"./index.esm-BOzCTtj1.js";function b({item:t}){var p,j,N;const[r]=_(),{refetch:n}=h(),a=S(),{id:s,avatar_url:l,tags:i,fields:v}=t,{email:w,["first name"]:y="",["last name"]:E=""}=v,u=((p=w[0])==null?void 0:p.value)??"",x=((j=y[0])==null?void 0:j.value)??"",f=((N=E[0])==null?void 0:N.value)??"",F=async C=>{try{await r(C),n(),c.success("Contact deleted successfull!")}catch(g){console.error(g),c.error(`Oops...! Something wrong... Error: ${g.data.human_readable_error}`)}};return e.jsxs("div",{className:"group flex",children:[e.jsx(L,{to:`/${s}`,state:{from:a},className:"w-full",children:e.jsxs("div",{className:"flex rounded-lg rounded-tr-none bg-[#3b3c3d] p-4 group-hover:bg-[#1d1d1d]",children:[e.jsx("div",{className:"mr-4 block h-[68px] min-w-[68px] overflow-hidden rounded-full",children:e.jsx("img",{src:l,alt:"Contact`s avatar",width:68,height:68,className:"h-[68px] w-[68px] object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-5",children:[x===""&&f===""?e.jsx("p",{children:"No any name"}):e.jsxs("div",{className:"flex flex-wrap gap-2 whitespace-pre-wrap",children:[e.jsx("p",{children:x}),e.jsx("p",{children:f})]}),u?e.jsx("b",{children:u}):e.jsx("b",{children:"No email"}),e.jsx(D,{id:s,tags:i})]})]})}),e.jsx(M,{id:s,onClick:F})]})}b.propTypes;function B(){const{data:t,error:r,isLoading:n,refetch:a}=h(),s=t?t.resources:[];return k.useEffect(()=>(a(),c.success("Okay! Let`s see what we have..."),()=>c.dismiss()),[]),e.jsx("section",{className:"mb-5",children:e.jsx("div",{className:"container",children:e.jsx("ul",{className:"flex flex-col gap-5",children:r?e.jsx(e.Fragment,{children:r.message}):n?e.jsx($,{}):s.length>0?s.map(l=>e.jsx("li",{children:e.jsx(b,{item:l})},l.id)):e.jsx(e.Fragment,{children:"No contacts found"})})})})}const I=O().shape({email:o().email("Invalid email format").required("Email is required"),firstName:o(),lastName:o()}).test("at-least-one","Either first name or last name is required",function(t){const{firstName:r,lastName:n}=t;return!r&&!n?this.createError({path:"lastName",message:"Either first name or last name is required"}):!0});function G(){const[t]=q(),{refetch:r}=h(),n={firstName:"",lastName:"",email:""};return e.jsx("section",{children:e.jsx("div",{className:"container",children:e.jsx(T,{initialValues:n,validationSchema:I,onSubmit:async(a,s)=>{const l={record_type:"person",fields:{...a.firstName&&{"first name":[{value:a.firstName}]},...a.lastName&&{"last name":[{value:a.lastName}]},email:[{value:a.email}]}};try{await t({...l}).unwrap(),s.resetForm(),c.success("New contact is added successfull!"),r()}catch(i){console.error(i.data.human_readable_error),c.error(`Oops...! Failed to create contact: ${i.data.human_readable_error}`)}finally{s.setSubmitting(!1)}},children:e.jsxs(A,{children:[e.jsxs("label",{htmlFor:"firstName",children:["First Name",e.jsx(m,{id:"firstName",type:"text",name:"firstName",placeholder:"Enter contact`s first name"}),e.jsx(d,{name:"firstName",component:"strong"})]}),e.jsxs("label",{htmlFor:"lastName",children:["Last Name",e.jsx(m,{id:"lastName",type:"text",name:"lastName",placeholder:"Enter contact`s last name"}),e.jsx(d,{name:"lastName",component:"strong"})]}),e.jsxs("label",{htmlFor:"email",className:"mb-4",children:["Email",e.jsx(m,{id:"email",type:"email",name:"email",placeholder:"Enter contact`s email"}),e.jsx(d,{name:"email",component:"strong"})]}),e.jsx("button",{type:"submit",className:"button",children:"Add contact"})]})})})})}function R(){return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"title",children:"Contacts"}),e.jsx(G,{}),e.jsx(B,{})]})}export{R as default};
